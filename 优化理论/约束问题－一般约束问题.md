[toc]

# 不等式约束问题

所谓一般约束问题，就是即含等式约束也含不等式约束的约束问题。

本文主要通过可行方向和下降方向的角度导出约束问题的必要条件和充分条件

## 可行方向和下降方向

### 不等式约束问题的一阶最优性条件（必要条件）
定义集合`$S$`为非线性约束问题的可行域。
```math
min \quad f(x) \\
st. \quad g(x) \leq 0
```
所以按照定义可知`$S= \{x | g(x) \leq 0 \}  \cap domf \cap domg$`

几个重要的集合

##### 可行方向组成的集合
在`$S$`内任意的一点`$\overline{x}$`,在沿着某个方向`$d$`搜索的时候，总是希望，在搜索方向上，只要步长`$\lambda > 0 $` 充分小，总是希望 `$\overline{x} + \lambda d \in S$` ,将这些方向收集起来，定义一个集合`$D$`.

如果`$S$`是非空集合`$S \subseteq R^n$`,假设`$\overline{x} \in cls$`，定义集合`$D$`为`$\overline{x}$`的**可行方向锥**集合。
`$D=\{d | d \neq 0, \overline{x} \in cl S, \exists \delta  >0 ,\forall \lambda \in (0,\delta) ,\overline{x} + \lambda d \in S \}$`

##### 下降方向集合
前面定义过目标函数的下降方向，将这些下降方向收集起来，定义一个集合`$F$`.

`$F=\{d| \exists \delta >0,\forall \lambda \in (0,\delta),f(\overline{x} + \lambda d) < f(\overline{x})\}$`

##### 下降方向集合1 

`$F_0=\{d| \nabla f(\overline{x})^T d  < 0 \}$`

对于约束问题为不等式的时候，可以采用搜索方向的方法，搜索极值点。

根据局部极值点的定义，可以这样思考,如果`$\overline{x}$`是局部极值点，那么可以这样认为，在`$\overline{x}$`不可能找到一个方向`$d$`,它既是可行方向又是下降方向，即不存在反向`$d$`，使得`$\nabla f(x)^T d < 0 ,d \in D$`,等价于如果存在方向`$d$`使得`$\nabla f(x)^T d < 0  $`则 `$d \notin D$`.

引理1  
如果`$\overline{x}$`是局部极值点，并且在点`$\overline{x}$`处可微，则有`$ F_0 \cap  D =  \empty$`.

proof:  
利用反证法，假设存在`$d \in F_0 \cap D$`.显然有`$d \in F_0$`,即`$\nabla f(\overline{x})^T d <0 $`根据下降方向定理可知,存在`$\delta_1 > 0$`，有`$\forall \lambda \in (0,\delta_1),f(\overline{x} + \lambda d) < f(\overline{x})$`.

也有`$d \in D$`,根据可行方向锥集合的定义可知，存在`$\delta_2 >0$`，有`$\forall \lambda \in (0,\delta_2), \overline{x} + \lambda d \in S$`.


令
```math
\delta = min\{\delta_1,\delta_2\}
```
则当`$\lambda \in (0,\delta)$`时，显然`$\overline{x}$`不是局部最优解。这个与假设矛盾，所以有`$F_0 \cap  D =  \empty$`.



`$\blacksquare$`



引理2  
如果`$F_0 \cap D =\empty$`,且函数`$f$`在`$\overline{x}$`处是pseudconvex,则存在`$\varepsilon >0$`,对于`$\forall x  \in S\cap N_\varepsilon(\overline{x})$`,则`$d = x - \overline{x} \in D$`.这个时候 `$\overline{x}$`是`$f$`的局部极值点。

proof:

由于函数`$f$`在`$\overline{x}$`是pseudconvex的，则对于`$\forall x \in S$`如果有`$\nabla f(\overline{x})^T(x -\overline{x}) \geq 0$`则有`$f(x) \geq f(\overline{x})$`.

假设`$\overline{x}$`不是`$f$`的局部极值点，对于所有的`$\varepsilon >0 $`, 对于任何集合`$S \cap N_\varepsilon(x)$`里总是存在`$\hat{x}$`使得`$f(\hat{x}) < f(\overline{x})$`.
显然`$d=\hat{x} - \overline{x}$`肯定是一个可行方向`$d \in D$`.


逆否命题成立，原命题必然成立。

`$\blacksquare$`




### 一般约束问题（含有等式约束）的一阶最优性条件
一般约束问题

```math
min \quad f(x) ,x \in R^n \\  
\vec{g}(x) \leq \vec{0} \\
\vec{h}(x) =\vec{0}
```
其中
`$\vec{g}(x)=( g_1(x),g_2(x),...,g_m(x) ) ^{T} , \vec{h}(x)=( h_1(x),h_2(x),...,h_l(x) ) ^{T}$`



广义拉格朗日函数：
```math
L(x,w,v)=f(x) + \sum_{i=1}^{m}w_i g_i(x) + \sum_{j=1}^{l}v_j h_j(x)
```

如果`$\overline{x}$`是一般约束问题的局部最优解，则存在乘子向量`$\overline{w} \geq 0$`和`$\overline{v}$`,使得
```math
\nabla_{x}L(\overline{x},\overline{w},\overline{v})=0
```
这样`$K-T$`乘子`$\overline{w}$`和`$\overline{v}$`称为lagrange乘子。
联立所有的条件，一般情形下的局部最优点满足
```math
\nabla_{x}L(\overline{x},\overline{w},\overline{v})=0 \\
g_i(\overline{x}) \leq 0,i=1,2,...,m \\
h_j(\overline{x})=0,j=1,2,...,l \\
\overline{w}_i g_i(\overline{x})=0 i=1,2,...,m \\
\overline{w}_i \geq 0,i=1,2,...,m
```
这里需要强调的是，每个点都有自己的一套lagrange乘子。

根据必要性的逻辑关系，可知如果某个点`$x$`是局部最优点，那么必然满足上述的关系，当然如果不满足`$K-T$`条件的点必然不是局部最优点，所以可通过先求解一般情形下的`$K-T$`条件，得到一些候选点，在这些候选点里，可以根据后续的充分性条件，具体问题的解存在情况，或者规划问题本身的形态来确定，候选点里面那些是局部最优点，那些时全局是最优点，那些点什么都不是，只是一个满足`$K-T$`条件的点而已。

#### 二阶条件
对于无约束问题来说，二阶条件时利用目标函数的Hesse矩阵给出的，然而，约束问题比无约束问题要复杂的得多，只是孤立的研究目标函数的Hesse矩阵是不行的。  

命题：对于约束问题，即使在K-T点目标函数的Hesse矩阵是正定的，这个点也不一定时最优解。  
proof:
对于可微的无约束问题来说，在局部最优点`$\overline{x}$`,任取`$p \in R^n$`,对其`$\overline{x}$`邻域的点`$x = \overline{x} + \lambda p  ,\lambda > 0 $`进行拉氏展开有
```math
f(\overline{x} + \lambda p)=f(\overline{x}) + \lambda \nabla f(\overline{x})^Tp + \lambda^2 p^T\nabla f(\overline{x})^Tp + o(\| \lambda p\|) 
```
由可微函数取局部最优解的必要条件知道`$\nabla f(\overline{x}) =0$`,所以


```math
f(\overline{x} + \lambda p)-f(\overline{x}) =  \lambda^2 p^T\nabla f(\overline{x})^Tp + o(\| \lambda p\|)

\Longrightarrow
\frac{f(\overline{x} + \lambda p)-f(\overline{x})}{\lambda^2} =   p^T\nabla f(\overline{x})^Tp + \frac{o(\| \lambda p\|)}{\lambda^2}
```
由于
```math
\lim\limits_{\lambda \to 0}(p^T\nabla f(\overline{x})^Tp + \frac{o(\| \lambda p\|)}{\lambda^2}) = p^T\nabla f(\overline{x})^Tp > 0
```
肯定存在一个小领域`$\lambda \in [0,\delta)$`,由极限的保号性可知,在这个邻域内有
```math
\frac{f(\overline{x} + \lambda p)-f(\overline{x})}{\lambda^2} > 0
```
所以
```math
f(\overline{x} + \lambda p) > f(\overline{x}) ,\forall \lambda \in [0,\delta),\forall p \in R^n
```
这个时候能保证`$\overline{x}$`是局部最优解，但是在有约束的情况下，`$K-T$`点上无法保证`$\nabla f(\overline{x}) =0$`,所以即使目标函数`$f(x)$`在`$K-T$`正定，`$\lambda \nabla f(\overline{x})^Tp$`在`$K-T$`点的符号不确定，也不能向上述过程那样推导下去。`$\blacksquare$`
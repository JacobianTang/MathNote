[toc]

[toc]

## 微积分基本定理

### 变上限积分
如果f(x)在$[a,b]$上是可积的,那么对任意$x \in [a,b]$，函数$f(x)$在$[a,x]$上也是可积的。那应以函数$F(a) = \int_{a}^{x}f(t)dt$
其中$x$在$[a,b]$上变化。
很显然有$F(a)=0,F(b)=\int_{a}^{b}f(x)dx$.

![变上限积分函数](./Image/变上限积分函数.png)

[**连续性**]设$f$在$[a,b]$上可积，那么上限变动的积分$F(x)=\int_{a}^{x}f(t)dt$在$[a,b]$上连续。
proof:
由于f在[a,b]上可积，那么必然有$|f(x)| \le M,\forall x \in [a,b]$
任取取定$x_0 \in [a,b]$

$$F(x_0 + h)-F(x_0)=\int_{a}^{x_0 + h}f(t)dt - \int_{a}^{x_0}f(t)dt\\
=\int_{x_0}^{x_0+h}f(t)dt $$
那么$|F(x_0 + h) -F(x_0)| =|\int_{x_0}^{x_0 + h}f(t)dt|\le M|h|$ 

分别$h> 0,h <0$讨论
如果$h >0$时$|F(x_0 + h) -F(x_0)| =|\int_{x_0}^{x_0 + h}f(t)dt|\le \int_{x_0}^{x_0+h}|f(t)|dt \le Mh=M|h|$ 
如果$h <0$，那么$|F(x_0 + h) -F(x_0)| =|\int_{x_0 +h}^{x_0}f(t)dt|\le \int_{x_0+h}^{x_0}|f(t)|dt \le -Mh=M|h|$ 

那么当然有$\lim\limits_{h \to 0}|F(x_0 +h) -F(x_0)| =0$
即$\lim\limits_{h \to 0}F(x_0 + h)=F(x_0)$
表明了$x_0$出$F(x)$的连续性，由于$x_0$出的任意性，可知函数$F(x)$在整个区间都是连续的。

$\blacksquare$


[**定理**]
设函数$f$在$[a,b]$上可积，在一点$x_0 \in [a,b]$处连续，那么$F(x)=\int_{a}^{x}f(t)dt$在$x_0$处可导，并且有$F'(x_0)=f(x_0)$.
proof:

题设本质是要证明$\lim\limits_{h \to 0}\frac{F(x_0 + h)-F(x_0)}{h}$存在，并且有$\lim\limits_{h \to 0}\frac{F(x_0 + h)-F(x_0)}{h} =f(x_0)$
不妨证明$\frac{F(x_0 + h)-F(x_0)}{h} -f(x_0)$是一个无穷小量
$$
\frac{F(x_0 + h)-F(x_0)}{h} -f(x_0)=\frac{\int_{x_0}^{x_0 + h}f(t)dt}{h}-f(x_0)\\
=\frac{\int_{x_0}^{x_0 + h}(f(t)-f(x_0))dt}{h}
$$
由于函数$f(x)$在$x_0$处是连续的，那么必然$\varepsilon >0$,$\exists \delta >0$,使得只要$|x -x_0| < \delta$,就有$|f(x) -f(x_0)|<\varepsilon$.

那么只要$0< |h| < \delta$,那么$t \in (x_0,x_0 + h)$必然有$|f(t)-f(x_0)| < \varepsilon$.

从而有$$
|\frac{F(x_0 + h)-F(x_0)}{h} -f(x_0)|=|\frac{\int_{x_0}^{x_0 + h}f(t)dt}{h}-f(x_0)|\\
=|\frac{\int_{x_0}^{x_0 + h}(f(t)-f(x_0))dt}{h}| \le \\
\frac{|\int_{x_0}^{x_0 + h}(f(t)-f(x_0))dt|}{|h|} \le 
\frac{\varepsilon |h|}{|h|}=\varepsilon
$$

这个说明$\lim\limits_{h \to 0}\frac{F(x_0 + h)-F(x_0)}{h}=f(x_0)$即$F'(x_0)=f(x_0)$

$\blacksquare$

[**微积分基本定理**]如果函数$f(x)$在$[a,b]$上连续，那么$\frac{d\int_{a}^{x}f(t)dt}{dx}=f(x),(a \le x \le b)$

这个说明了如果函数$f(x)$在区间是连续的，那么$\int_{a}^{x}f(t)dt$是f的一个原函数。


[**推论**]
$[a,b]$上的连续函数$f(x)$一定有原函数。

proof:

前面的引理证明了$\int_{a}^{x}f(t)dt$就是$f(x)$在区间上的原函数。

$\blacksquare$

### Newton-Leibniz公式
[**形式1**]
函数$f$在$[a,b]$上是可积的，且在$(a,b)$上有原函数$F(x)$,即$F'(x)=f(x),\forall x \in [a,b]$,如果$F$在[a,b]上连续，那么必有$\int_{a}^{b}f(x)dx=F(b) -F(a)$
proof:
首先需要注意的是如果函数F(x)在$(a,b)$上是可导的，必然在$(a,b)$是连续的，那么强调函数$F(x)$在闭区间连续的含义是为了保证函数在$x=a,x=b$处连续。

确定一个分割，不妨将[a,b]区间n等分。$P:a=x_0 < x_1 < ...< x_n=b$,即$\Delta x_i = x_i - x_{i-1}=\frac{b-a}{n}$.

于是$F(b)-F(a) = \sum_{i=1}^{n}F(x_i)-F(x_{i-1})$
对于F应用微分中值定理，a，b点的连续，正好可以确保第一个和最后一个区间也是可以使用微分中值定理的。
那么
$F(b)-F(a) = \sum_{i=1}^{n}F(x_i)-F(x_{i-1})=\sum_{i=1}^{n}F'(\xi_i)(x_i -x_{i-1})=\sum_{i=1}^{n}f(\xi_i)\Delta x_i$


这里$\xi \in (x_{i-1},x_i)$.由于$f(x)$是可积的，那么必然有$\lim\limits_{n \to \infty}\sum_{i=1}^{n}f(\xi)\Delta x_i=\lim\limits_{|P|\to 0}\sum_{i=1}^{n}f(\xi)\Delta x_i$是存在，并且等于$\int_{a}^{b}f(x)dx$.

从而有$\int_{a}^{b}f(x)dx=F(b)-F(a)$

$\blacksquare$
将求可积函数的积分的问题，转化为求f的原函数的问题。

[**形式2**]




[**形式3**]
设$f(x)$在[a,b]上连续，$G$是$f$的任意一个原函数，那么
$$\int_{a}^{b}f(x)dx=G(b)-G(a)$$
proof:
根据微积分基本定理知道$\int_{a}^{x}f(t)dt$是$f(x)$一个原函数.
又因为$G(x)$也是其一个原函数，那么必然有$\int_{a}^{x}f(t)dt=G(x)+c,\forall x \in [a,b]$
那么$\int_{a}^{a}f(t)dt = G(a) +c =0$所以$c=-G(a)$
所以$\int_{a}^{x}f(t)dt=G(x)-G(a)$

不妨取$x=b$则有$\int_{a}^{b}f(t)dt =G(b)-G(a)$
有因为$\int_{a}^{b}f(x)dx =\int_{a}^{b}f(t)dt = G(b)-G(a)$
得证。

$\blacksquare$

[**推论**]

如果函数$G(x)$在$[a,b]$上有连续的导函数，那么
$\int_{a}^{x}G'(t)dt = G(x)-G(a)(a \le x \le b)$
proof:
这里$G'(x)$是连续的是必要的，因为这个连续性才能确定$\int_{a}^{x}G'(t)dt$是$G'(x)$的一个原函数。

毫无疑问的是$G(x)$当然也是$G'(x)$的原函数，那么利用微积分基本定理，自然就有$\int_{a}^{x}G'(t)dt =G(x)-G(a)$

$\blacksquare$
微积分基本定理和其推论，包含了两个方面的内容，第一是说一个连续函数的原函数可以通过变上线积分来确定，第二就是一个函数的导数积分可以还原到这个函数的本身。

定理的重要性在于它沟通了导数和积分之间的关系，以及求导和求积分之间的关系。

## 定积分的计算方法

### 分部积分里面的一个疑问
$\int_{a}^{b}f(x)d\varphi(x) = \sum_{i=1}^{n}f(x)(\varphi(x_i) - \varphi(x_{i-1}))=\sum_{i=1}^{n}f(x)\varphi'(\xi)(x_i - x_{i-1})$
1.这里需要强调的是,这样类似的积分形式,称为$Stieltjes$积分.
2.这里的积分范围依然是x的范围,$x \in [a,b]$.而不是$\varphi(x) \in [a,b]$.
3.不加证明的可以认为$\int_{a}^{b}f(x)d\varphi(x)=\int_{a}^{b}f(x)\varphi'(x)dx$

一般来说,会这样做的时候一般都是使用分部积分的时候,这样确实给学习者带了了很多困扰,其实是有办法取消除这样的歧义的.

$f(x)=f(x_0) + \int_{x_0}^{x}f'(t)dt$

一种形式是,这个也是很多教科书上的写法$f(x)=f(x_0) + \int_{x_0}^{x}f'(t)dt=f(x_0) + \int_{x_0}^{x}f'(t)d(t-x)=f(x_0) + (t-x)f'(t)|_{x_0}^{x} -\int_{x_0}^{x}f''(t)(t-x)dt$
然后使用分部积分进行展开.

如果换种更加贴近分部积分原始形式的写法,是不会带来这样的歧义的
$f(x)=f(x_0) + \int_{x_0}^{x}f'(t)dt=f(x_0) + \int_{x_0}^{x}(t-x)'f'(t)dt=f(x_0) + (t-x)f'(t)|_{x_0}^{x} -\int_{x_0}^{x}f''(t)(t-x)dt$
这里将$(t-x)'=v'(t),f'(t) = u(t)$自然有
$\int_{x_0}^{x}v'(t)u(t)dt=v(t)u(t)-\int_{x_0}^{x}u'(t)v(t)dt$与之对应的就是
$\int_{x_0}^{x}(t-x)'f'(t)dt=(t-x)f'(t)|_{x_0}^{x} -\int_{x_0}^{x}f''(t)(t-x)dt$
这样便不会出现有歧义的地方,但是达到的效果确实一样的.

### 定积分换元法

$$\int_{g(a)}^{g(b)}f(u)du=\int_{a}^{b}f(g(x))g'(x)dx$$

proof:
不妨假设$f(u)$的原函数为$F(u)$,即$F'(u)=f(u)$利用$Newton-Leibniz$公式有
$\int_{g(a)}^{g(b)}f(u)du = F(u)|_{g(a)}^{g(b)}=F(g(b))-F(g(a))$

很显然的是$F(g(x))$是$f(g(x))g'(x)$的原函数.
因为$dF(g(x))/dx=F'(g(x))g'(x)=f(g(x))g'(x)$
那么可以知道$\int_{a}^{b}f(g(x))g'(x)dx=F(g(x))|_{a}^{b}=F(g(b))-F(g(a))$
由此可见是成立的.
$\blacksquare$

### 定积分凑微分

一般来说求解类似$\int_{a}^{b}f(g(x))g'(x)dx$的定积分采用凑微分的方法,但是用凑微分的时候,让人疑惑的是到底要不要改变积分上下限.
根据定积分的换元法我们知道,$u=g(x),x \in [a,b]$那么必然有
$\int_{g(a)}^{g(b)}f(u)du=\int_{a}^{b}f(g(x))g'(x)dx$

疑惑点在于要证明$\int_{a}^{b}f(g(x))g'(x)dx = \int_{a}^{b}f(g(x))dg(x)$

$\int_{a}^{b}f(g(x))dg(x)$这个里面的a,b是x的范围,利用换元令$u=g(x)$,那么$\int_{a}^{b}f(g(x))dg(x)$可以变成$\int_{g(a)}^{g(b)}f(u)du$.

根据前面的证明,我们是知道$\int_{g(a)}^{g(b)}f(u)du=\int_{a}^{b}f(g(x))g'(x)dx$

那么就有$\int_{a}^{b}f(g(x))dg(x)=\int_{a}^{b}f(g(x))g'(x)dx$

试想一个问题,如果$\int_{a}^{b}f(g(x))dg(x)$这个里面的a,b是g(x)的范围,进行换元后,那么$\int_{a}^{b}f(g(x))dg(x)$可以变成$\int_{a}^{b}f(u)du$.很显然$\int_{a}^{b}f(u)du \ne \int_{a}^{b}f(g(x))g'(x)dx$




# 误差分析

线性逼近误差 

$$
R_1(x)=f(x) - f(x_0) - f'(x_0)(x-x_0)
$$

二次逼近误差  

$$
R_2(x)=f(x) - f(x_0) - f'(x_0)(x-x_0)-f''(x_0)(x-x_0)^2/2
$$

如果$f(x)$有二阶连续导数,实际上这个保证了在$x_0$的邻域里，$f(x)$是二阶可导的，假设$f''(x_0) \ne 0$


$$
\begin{aligned}
\lim\limits_{x \to x_0}\frac{R_2(x)}{R_1(x)}=&\lim\limits_{x \to x_0}\frac{f(x) - f(x_0) - f'(x_0)(x-x_0)-f''(x_0)(x-x_0)^2/2}{f(x) - f(x_0) - f'(x_0)(x-x_0)}\\
=&\lim\limits_{x \to x_0}\frac{f'(x) - f'(x_0)-f''(x_0)(x-x_0)}{f'(x) - f'(x_0)} \\
=&\lim\limits_{x \to x_0}\frac{f''(x) -  f''(x_0)}{f''(x)} = \frac{0}{f''(x_0)}=0  \\
[最后一步,使用洛必达法则，需x_0邻域内二阶可导]
\end{aligned}
$$

$$
f''(x_0)=\lim\limits_{x \to x_0}\frac{f'(x) - f'(x_0)}{x-x_0}
$$
$f''(x_0)$存在,说明在$(x_0 -\delta ,x_0 + \delta)$邻域内函数$f'(x)$有定义,$f(x)$是可导的,要不然不可能在点$x_0$处有二阶导数存在.这些推论,保证了洛必达法则的应用.

另可以弱化条件,只需要$f''(x_0)$存在即可,也就是$\lim\limits_{x \to x_0}{\frac{f'(x) - f'(x_0)}{(x-x_0)}}$存在.

$$
\begin{aligned}
\lim\limits_{x \to x_0}\frac{R_2(x)}{R_1(x)}=&\lim\limits_{x \to x_0}\frac{f(x) - f(x_0) - f'(x_0)(x-x_0)-f''(x_0)(x-x_0)^2/2}{f(x) - f(x_0) - f'(x_0)(x-x_0)}\\
=&\lim\limits_{x \to x_0}\frac{f'(x) - f'(x_0)-f''(x_0)(x-x_0)}{f'(x) - f'(x_0)} \\
=&\lim\limits_{x \to x_0}[1-\frac{f''(x_0)}{\frac{f'(x) - f'(x_0)}{(x-x_0)}}] \\
=&1 - \lim\limits_{x \to x_0}\frac{f''(x_0)}{\frac{f'(x) - f'(x_0)}{(x-x_0)}}=1 -\frac{f''(x_0)}{f''(x_0)}=0
\end{aligned}
$$


那么利用极限语言就是$\forall \varepsilon >0,\exists \delta >0,|x-x_0| < \delta$有
$$|\frac{R_2(x)}{R_1(x)}| < \varepsilon$$

不妨取$\varepsilon = 1$,那意味着存在$\delta_0 >0$,当$|x-x_0| < \delta_0$时
$$ |\frac{R_2(x)}{R_1(x)}| < 1 \Rightarrow |R_2(x)| < |R_1(x)|$$

也就是必然存在一个邻域,使得二次逼近的误差要小于线性逼近的误差,并不意味着任意的点上都有$|R_2(x)| < |R_1(x)|$存在.换句话说,当$x$离$x_0$足够近,必然有二次逼近的误差要小于线性逼近的误差.

从这里也体现了用高阶逼近的的意义所在,逼近理论里面的局部特性和区间特性是两回事.

如果函数$f(x)$在点$x_0$处可微(可导)
$$
\lim\limits_{x \to x_0}\frac{f(x) -f(x_0)}{x - x_0} =f'(x_0)
$$
很显然有
$$
\lim\limits_{x \to x_0}\frac{f(x) -f(x_0)-f'(x_0)(x-x_0)}{x - x_0} =0
$$
故有 
$f(x) =f(x_0) + f'(x_0)(x-x_0)+ o((x-x_0))$

假设$f''(x_0)$存在的条件下,$f(x)$能不能用$x-x_0$的一个二次多项式来近似,并使得其误差当$x \to x_0$时是比$(x-x_0)^2$高阶的无穷小,也就是
$$
f(x)=A_0 + A_1(x-x_0) + A_2(x-x_0)^2 + o((x-x_0)^2)
$$
接下来的问题就是如何确定多项式的系数.

利用函数的连续性可知
$$
A_0 =\lim\limits_{x \to x_0}f(x)=f(x_0)
$$

$$
\lim\limits_{x \to x_0}\frac{f(x)-f(x_0)}{x-x_0}=\lim\limits_{x \to x_0}[A_1 + A_2(x-x_0) + o((x-x_0))]=A_1  \\

\lim\limits_{x \to x_0}\frac{f(x)-f(x_0)}{x-x_0} = f'(x_0)
$$
就有$A_1 = f'(x_0)$


$$
\begin{aligned}
\lim\limits_{x \to x_0}\frac{f(x)-f(x_0)-f'(x_0)(x-x_0)}{(x-x_0)^2}
&=\lim\limits_{x \to x_0}\frac{f'(x)-f'(x_0)}{2(x-x_0)} \\
&=\frac{f''(x_0)}{2}=A_2
\end{aligned}
$$

反过来证明如果

$P(x)=f(x_0) + f'(x_0)(x-x_0) + f''(x_0)(x-x_0)^2/2$  
那么
$$R(x) = f(x)-P(x),R(x)=o((x-x_0)^2)$$


$$
\begin{aligned}
\lim\limits_{x \to x_0}\frac{f(x)-P(x)}{(x-x_0)^2}=&\lim\limits_{x \to x_0}\frac{f(x)-f(x_0) - f'(x_0)(x-x_0) - f''(x_0)(x-x_0)^2/2}{(x-x_0)^2} \\
=&\lim\limits_{x \to x_0}\frac{f'(x)-f'(x_0)-f''(x_0)(x-x_0)}{2(x-x_0)} \\
=&\frac{1}{2}\lim\limits_{x \to x_0}[\frac{f'(x)-f'(x_0)}{(x-x_0)} -f''(x_0)] \\
=&\frac{1}{2}(f''(x_0) - f''(x_0)) 
= 0
\end{aligned}
$$



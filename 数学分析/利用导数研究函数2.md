[toc]

## taylor多项式的导出思路

### 与多项式性质类比
...

### 从微分的性质归纳
如果函数$f(x)$在点$x_0$处可微(可导),记$\lim\limits_{x \to x_0}\frac{f(x) -f(x_0)}{x - x_0} =f'(x_0)$
我们根据可微的性质，我们知道
$$f(x) =f(x_0) + f'(x_0)(x-x_0)+ o((x-x_0)) \tag{1}$$

假设$f''(x_0)$存在的条件下,$f(x)$能不能用$x-x_0$的一个二次多项式来近似,并使得其误差当$x \to x_0$时是比$(x-x_0)^2$高阶的无穷小,也就是
$$f(x)=A_0 + A_1(x-x_0) + A_2(x-x_0)^2 + o((x-x_0)^2) \tag{2}$$
接下来的问题就是如何确定多项式的系数.

既然$f(x)$在$x_0$处二阶导数都是存在的，函数必然在$x_0$处是连续的可知
$$A_0 =\lim\limits_{x \to x_0}f(x)=f(x_0)$$
有因为函数在$x_0$处必然是可导的，所以
$$f'(x_0)=\lim\limits_{x \to x_0}\frac{f(x)-f(x_0)}{x-x_0}=\\
\lim\limits_{x \to x_0}[A_1 + A_2(x-x_0) + o(x-x_0)]=A_1$$
就有$A_1 = f'(x_0)$

为了求$A_2$我们知道事实就是
$A_2=\lim\limits_{x \to x_0}\frac{f(x)-f(x_0)-f'(x_0)(x-x_0)}{(x-x_0)^2}$

因为函数$f(x)$在$x_0$处二阶可导，根据二阶导数的定义$f''(x_0)=\lim\limits_{x \to x_0}\frac{f'(x)-f'(x_0)}{x-x_0}$，意味着$f(x)$在$x_0$的某个邻域里是可导的.
则$f(x)-f(x_0)-f'(x_0)(x-x_0)$在这个邻域里也是可导的，并且还有$\lim\limits_{x \to x_0}[f(x)-f(x_0)-f'(x_0)(x-x_0)]=0$
那么就可以利用洛必达法则求极限
$$\lim\limits_{x \to x_0}\frac{f(x)-f(x_0)-f'(x_0)(x-x_0)}{(x-x_0)^2}
=\lim\limits_{x \to x_0}\frac{f'(x)-f'(x_0)}{2(x-x_0)} 
=\frac{f''(x_0)}{2}$$
那么就有$A_2=\frac{f''(x_0)}{2}$

现在我们要证明，用二次多项式逼近的余项是不是满足我们的前面提到的要求？
记$r(x)=f(x)-[f(x_0) + f'(x_0)(x-x_0) + f''(x_0)(x-x_0)^2/2]$
与前面的分析类似，我们可以确定的是$\lim\limits_{x \to x_0}r(x)=0$,并且$r(x)$在含有$x_0$的某个邻域里是可导的。
那么
$$\lim\limits_{x \to x_0}\frac{r(x)}{(x-x_0)^2}=\lim\limits_{x \to x_0}\frac{r'(x)}{2(x-x_0)}\\
=\lim\limits_{x \to x_0}\frac{f'(x)-f(x_0)-f''(x_0)(x-x_0)}{2(x-x_0)}\\
=\lim\limits_{x \to x_0}\frac{f'(x)-f(x_0)}{2(x-x_0)}-f''(x_0)/2=\frac{f''(x_0)}{2}-\frac{f''(x_0)}{2}=0$$
所以就有
$r(x)=o((x-x_0)^2)$
> 注
根据函数$f(x)$在点$x_0$处有二阶导数的条件，$\lim\limits_{x \to x_0}\frac{f'(x)-f(x_0)-f''(x_0)(x-x_0)}{2(x-x_0)}$这一步不能用洛必达法则，因为无法确定在$x_0$附近的邻域里是可导的。

利用极限的唯一性，前面的分析求解$A_i$的过程中，可以确定的是$A_i$是唯一存在的。
这个就证明了存在唯一的二次多项式，即
$f(x_0) + f'(x_0)(x-x_0) + f''(x_0)(x-x_0)^2/2$  

这个也就有了
$$f(x)=f(x_0) + f'(x_0)(x-x_0) + \frac{f''(x_0)}{2}(x-x_0)^2 + o((x-x_0)^2) \\
\tag{3}$$
很显然再继续下去，不会有任何本质的困难

## 带佩亚诺余项的Taylor定理
[**定义**]
设函数$f(x)$在点$x_0$处有直到$n$阶的导数，这里$n$是任意给定的正整数，令
$$T_n(f,x_0;x)=f(x_0)+f'(x_0)(x-x_0)+\frac{1}{2}f''(x_0)(x-x_0)^2+...\\+\frac{1}{n!}f^{(n)}(x_0)(x-x_0)^n \tag{4}$$
称其为$f(x)$在$x_0$处的n次Taylor多项式。

[**定理1**]
设函数$f(x)$在点$x_0$处有直到$n$阶的导数，则有
$$f(x)=f(x_0)+f'(x_0)(x-x_0)+\frac{1}{2}f''(x_0)(x-x_0)^2+...\\+\frac{1}{n!}f^{(n)}(x_0)(x-x_0)^n + o((x-x_0)^n),x \to x_0 \tag{5}$$

proof:

因为$f(x)$在$x_0$有n阶的导数，说明必然在一个含$x_0$的邻域内$f(x)$是$n-1$阶可导的，不妨记
$r(x)=f(x)-[f(x_0)+f'(x_0)(x-x_0)+\frac{1}{2}f''(x_0)(x-x_0)^2+...\\+\frac{1}{n!}f^{(n)}(x_0)(x-x_0)^n]$
有$r(x_0)=0$并且$r(x)$在这个邻域里也是$(n-1)$阶可导的
$$r'(x)=f'(x)-[f'(x_0)+f''(x_0)(x-x_0)+...+\frac{1}{(n-1)!}f^{(n)}(x_0)(x-x_0)^{n-1}]\\
r''(x)=f''(x)-[f''(x_0)+ f'''(x_0)(x-x_0)+...+\frac{1}{(n-2)!}f^{(n)}(x_0)(x-x_0)^{n-2}]\\
...\\
r^{(n-1)}(x)=f^{(n-1)}(x)-[f^{(n-1)}(x_0)+f^{(n)}(x_0)(x-x_0)] \tag{6}$$

$r'(x_0)=0,r''(x_0)=0,...,r^{(n-2)}(x_0)=0,r^{(n-1)}(x_0)=0$
那么
$\lim\limits_{x \to x_0}\frac{r(x)}{(x-x_0)^{n}}=\lim\limits_{x \to x_0}\frac{r'(x)}{n(x-x_0)^{n-1}}=...=\lim\limits_{x \to x_0}\frac{r^{(n-2)}(x)}{(n*(n-1)*...*3)(x-x_0)^{2}}$
因为$r(x)$在邻域里有$n-1$阶导数，那意味着$r^{(n-2)}(x)$在这个邻域还是可导的，又因为$r^{(n-2)}(x_0)=0$故有
$$\lim\limits_{x \to x_0}\frac{r(x)}{(x-x_0)^{n}}=\lim\limits_{x \to x_0}\frac{r'(x)}{n(x-x_0)^{n-1}}=...=\lim\limits_{x \to x_0}\frac{r^{(n-2)}(x)}{(n*(n-1)*...*3)(x-x_0)^{2}}\\
=\lim\limits_{x \to x_0}\frac{r^{(n-1)}(x)}{(n*(n-1)*...*2)(x-x_0)}\\
=\lim\limits_{x \to x_0}\frac{f^{(n-1)}(x)-f^{(n-1)}(x_0)-f^{(n)}(x_0)(x-x_0)]}{(n*(n-1)*...*2)(x-x_0)}\\
=\frac{1}{n!}[\lim\limits_{x \to x_0}\frac{f^{(n-1)}(x)-f^{(n-1)}(x_0)}{x-x_0}-f^{(n)}(x_0)]=0 \tag{7}$$

需要注意的是，整个求极限的过程可以使用(n-1)次洛必达法则，最后一次不可以使用洛必达法则。

那么命题要求证明的结论就证明完毕了。

$\blacksquare$

不妨用数学归纳法来证明。
当n=1时，根据可微性，我们知道
$f(x)=f(x_0)+f'(x_0)(x-x_0)+o(x-x_0)$
那么命题的结论是正确的。
不妨假设命题当$n=k$时也是成立的，即$f(x)$在$x_0$处有$k$阶导数有
$f(x)=f(x_0) +f'(x_0)(x-x_0) +...+\frac{f^{(k)}(x_0)}{k!}(x-x_0)^k + o((x-x_0)^k)$
那么当$n=k+1$时，即$f(x)$在$x_0$处有$k+1$阶导数
那么
$$r(x)=f(x)-[f(x_0)+f'(x_0)(x-x_0)+...+\frac{f^{(k+1)}(x_0)}{(k+1)!}(x-x_0)^{k+1}]$$
很显然$r(x_0)=0$而$r(x)$是在邻域内是可导的，故
$$\lim\limits_{x \to x_0}\frac{r(x)}{(x-x_0)^{k+1}}=\lim\limits_{x \to x_0}\frac{r'(x)}{(k+1)(x-x_0)^k}\\
=\frac{1}{k+1}\lim\limits_{x \to x_0}\frac{f'(x)-[f'(x_0) +...+\frac{f^{(k+1)}(x_0)}{k!}(x-x_0)^k]}{(x-x_0)^k} \tag{8}$$

因为$f(x)$在$x=x_0$处有$n+1$阶导数，那么$f'(x)$在$x=x_0$处有n阶导数，那么意味着
$$f'(x)=f'(x_0) +f''(x_0)(x-x_0) +...+\frac{f^{(k+1)}(x_0)}{(k+1)!}(x-x_0)^k + o((x-x_0)^k) \\
\tag{9}$$
那么将(9）代入（8）式有
$$\lim\limits_{x \to x_0}\frac{r(x)}{(x-x_0)^{k+1}}=\lim\limits_{x \to x_0}\frac{r'(x)}{(k+1)(x-x_0)^k}\\
=\frac{1}{k+1}\lim\limits_{x \to x_0}\frac{f'(x)-[f'(x_0) +...+\frac{f^{(k+1)}(x_0)}{k!}(x-x_0)^k]}{(x-x_0)^k}=0 \\
\tag{10}$$

这个也就证明了$r(x)=o((x-x_0)^{k+1})$

根据数学归纳法可知，命题是成立的。

[**定义**]
令
$$R_n(x)=f(x)-\sum_{k=0}^{n}\frac{f^{(k)}(x_0)}{k!}(x-x_0)^k \tag{11}$$
称之为余项。
当然，对余项，我们只知道
$$\lim\limits_{x \to x_0}\frac{R_n(x)}{(x-x_0)^n}=0 \tag{12}$$
我们称这样的余项为佩亚诺余项。
这个定理告诉我们，在$x_0$的近旁，一个很复杂的函数可以用多项式来近似它，公式的右边按照层次以及数值上重要性从重要到次重要一次摆了出来。虽然余项一般已不是多项式，但是比起前面那些项的总和，已经微不足道。


称多项式
$$P(x)=f(0)+f'(x_0)x +\frac{f''(x_0)}{2}+...+ \frac{f^{(n)}(0)}{n!}x^n \tag{13}$$
为f的n次麦克劳林多项式，相应地有
$$
f(x)=f(0)+f'(x_0)x +\frac{f''(x_0)}{2}+...+ \frac{f^{(n)}(0)}{n!}x^n + o(x^n) \\
\tag{14}$$

一般来说，我们称(5)(14)为函数f的$Taylor$展开式或者麦克劳林展开式。

## 带拉式余项和柯西余项的Taylor定理
令函数$f(x)$在$x_0$处n阶展开的余项为
$$r_n(x)=f(x)-
[f(x_0)+f'(x_0)(x-x_0)+...+\frac{f^{(n)}(x_0)}{n!}(x-x_0)^n]$$
下面的定理将给出n阶展开余项的具体表达式。
基于taylor展开的佩亚诺余项，只能给出$x \to x_0$时$r_n(x) \to 0$的感性结论。

我们不能由此确定，对于怎么样的x，数值多项式$p(x)$可以表达式函数$f(x)$至多高的精度，即误差有多大，它也没有说到对于已经给定的x而言，由于n的增大，余项$r_n(x)$的数值收到什么影响。

[**定理2**]
如果函数$f$和它的前n阶导数在以$x_0,x$为端点的闭区间上连续，且f在该区间的内点上有$n+1$阶导数，则对于在这个闭区间上连续并且在其内点上可导，且导数不为零任何函数$\varphi$,都可以求出介于$x_0$和$x$之间的$\xi$,使得
$$r_n(x)=\frac{\varphi(x)-\varphi(x_0)}{\varphi'(\xi)n!}f^{(n+1)}(\xi)(x-\xi)^n \tag{15}$$

为了描述简单，不妨设$x > x_0$，实际上反过来也是成立的。

$\star$如果函数$f$和它的$f^{(i)},i=1,...,n$在闭区间$[x_0,x]$上连续，并且函数$f$在开区间$(x_0,x)$上可导，则对于在闭区间$[x_0,x]$上连续的函数$\varphi$,并且$\varphi$满足在开区$(x_0,x)$上可导，并且$\forall t \in (x_0,x),\varphi'(t) \ne 0$,那么必然存在$\xi \in (x_0,x)$使得
$$r_n(x)=\frac{\varphi(x)-\varphi(x_0)}{\varphi'(\xi)n!}f^{(n+1)}(\xi)(x-\xi)^n$$

proof:
考虑$x_0$的一个邻域$[x_0,x_0+h]$，假设$x \in [x_0,x_0+h]$那么
$[x_0,x]\subset [x_0,x_0+h]$
把$f(x)$在$x=x_0$处展开，实际上余项可以写成

$$r_n(x)=f(x)-[f(x_0)+f'(x_0)(x-x_0)+...+\frac{f^{(n)}(x_0)}{n!}(x-x_0)^n]$$

现在将$x$固定在区间$[x_0,x_0+h]$内的任一数值，并且给出其余项公式，把常数$x_0$换成变量$t$,做一个辅助函数，并且很显然变量t可以在$[x_0,x]$内变动。
$F(t)=f(x)-[f(t)+f'(t)(x-t)+...+\frac{f^{(n)}(t)}{n!}(x-t)^n]$
由于$f,f',...,f^{(n)}$在区间$[x_0,x]$上是连续的，并且$f$在区间$(x_0,x)$上有$(n+1)$阶导数，这个意味着$F(t)$在闭区间$[x_0,x]$是连续的，并且在$(x_0,x)$是可导的。
计算其导数有$F'(t)=-\frac{f^{(n+1)}(t)}{n!}(x-t)^n,t \in (x_0,x)$

今天选择任意函数$\varphi(t)$,命题说其在$[x_0,x]$是连续的，且至少在$(x_0,x)$是可导的，且导数均不为0.对$F(t),\varphi(t)$使用柯西中值定理就有
$$\frac{F(x)-F(x_0)}{\varphi(x)-\varphi(x_0)}=\frac{F'(\xi)}{\varphi'(\xi)},\xi \in (x_0,x)$$

我们知道$F(x_0)=r_n(x),F(x)=0$
那么就有
$r_n(x)=F(x_0)-F(x)=-[\varphi(x)-\varphi(x_0)]\frac{F'(\xi)}{\varphi'(\xi)}=\frac{\varphi(x)-\varphi(x_0)}{\varphi'(\xi)}\frac{f^{(n+1)}(\xi)}{n!}(x-\xi)^n,\xi \in (x_0,x)$

取$\varphi(t)=x-t$我们就可以得到**柯西余项**
$$r_n(x)=\frac{\varphi(x)-\varphi(x_0)}{\varphi'(\xi)}\frac{f^{(n+1)}(\xi)}{n!}(x-\xi)^n\\
=\frac{f^{(n+1)}(\xi)}{n!}(x-\xi)^n(x-x_0) \\
\tag{16}$$
其中$\xi$处于$x_0$和$x$的形成的开区间里面。
不妨假设$\xi = x_0+\theta(x-x_0),\theta \in (0,1)$那么柯西余项可以改成
$$r_n(x)=\frac{f^{(n+1)}(x_0+\theta(x-x_0))}{n!}(1-\theta)^n(x-x_0)^{n+1} \\
\tag{17}$$
取$\varphi(t)=(x-t)^{n+1}$那么
$$r_n(x)=\frac{\varphi(x)-\varphi(x_0)}{\varphi'(\xi)}\frac{f^{(n+1)}(\xi)}{n!}(x-\xi)^n\\
=\frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)^{n+1} \\
\tag{18}$$
这个就是著名的**拉式余项**。
$\blacksquare$

不同的教科书上关于条件会有很多不同的表示方式，但实际上都是要满足本定理里叙述的条件。

有些书会直接简单的要求$f(x)$在开区间$(a,b)$上有$n+1$阶导数，$x_0,x \in (a,b)$，实际想想它是满足定理2的要求的。
像定理2那样严谨的描述的好处就是，当$x_0$或者$x$是闭区间的端点时候，更加方便去讨论。


[**引理**]
设函数$f(x)$在$U(0,\eta)$有定义，在$0$点$n$次可导，如果
$$f'(x)=A_0+A_1x+...+A_{n-1}x^{n-1} + o(x^{n-1})$$
那么
$$f(x)=f(0)+A_0x+\frac{A_1}{2}x^2 +...+\frac{A_{n-1}}{n}x^{n}+o(x^n)$$
proof:  

$f(x)$在$x=0$处有$n$阶导数，那意味着$f'(x)$在$x=0$处有$n-1$阶导数，那必然有
$$f'(x)=f'(0)+f''(0)x+...+\frac{f^{(n)}(0)}{(n-1)!}x^{n-1} + o(x^{n-1})$$
因为Taylor级数的唯一性，我们可以知道
$$A_0=f'(0),A_1=f''(0),2A_2=f'''(0),...,A_{n-1}=\frac{f^{(n)}(0)}{(n-1)!}$$

$f(x)$在$x=0$处有$n$阶导数,根据带佩亚诺余项的泰勒定理，$f(x)$可以写成
$$f(x)=f(0)+f'(0)x+...+\frac{f^{(n)}(0)}{n!}x^n +o(x^n)\\
=f(0)+A_0x+\frac{A_1}{2}x^2+...+\frac{A_{n-1}}{n}x^n+o(x^n)$$

那么命题得证．

$\blacksquare$

这个引理对于某些函数的展开式而言非常有用．
从形式上来看，从方便使用的角度来看
$f(x)-f(0)=\int_{0}^{x}f'(t)dt=\int_{0}^{x}[A_0+A_1t+...+A_{n-1}t^{n-1} + o(t^{n-1})]dt$

## 积分余项


## 常见初等函数的Taylor展开式和误差公式



## Taylor定理的使用


## 高阶逼近的局部优势

线性逼近误差 
$R_1(x)=f(x) - f(x_0) - f'(x_0)(x-x_0)$
二次逼近误差  
$R_2(x)=f(x) - f(x_0) - f'(x_0)(x-x_0)-f''(x_0)(x-x_0)^2/2$

只需要$f''(x_0)$存在即可,也就是$\lim\limits_{x \to x_0}{\frac{f'(x) - f'(x_0)}{(x-x_0)}}$存在.

$$
\lim\limits_{x \to x_0}\frac{R_2(x)}{R_1(x)}=\lim\limits_{x \to x_0}\frac{f(x) - f(x_0) - f'(x_0)(x-x_0)-f''(x_0)(x-x_0)^2/2}{f(x) - f(x_0) - f'(x_0)(x-x_0)}\\
=\lim\limits_{x \to x_0}\frac{f'(x) - f'(x_0)-f''(x_0)(x-x_0)}{f'(x) - f'(x_0)} \\
=\lim\limits_{x \to x_0}[1-\frac{f''(x_0)}{\frac{f'(x) - f'(x_0)}{(x-x_0)}}] =1 - \lim\limits_{x \to x_0}\frac{f''(x_0)}{\frac{f'(x) - f'(x_0)}{(x-x_0)}}=1 -\frac{f''(x_0)}{f''(x_0)}=0
$$

那么利用极限语言就是$\forall \varepsilon \gt 0,\exists \delta \gt 0,|x-x_0| < \delta$有
$$|\frac{R_2(x)}{R_1(x)}| < \varepsilon$$

不妨取$\varepsilon = 1$,那意味着存在$\delta_0 \gt 0$,当$|x-x_0| < \delta_0$时
$$ |\frac{R_2(x)}{R_1(x)}| < 1 \Rightarrow |R_2(x)| < |R_1(x)|$$

也就是必然存在一个邻域,使得二次逼近的误差要小于线性逼近的误差,并不意味着任意的点上都有$|R_2(x)| < |R_1(x)|$存在.换句话说,当$x$离$x_0$足够近,必然有二次逼近的误差要小于线性逼近的误差.

从这里也体现了用高阶逼近的的意义所在,逼近理论里面的局部特性和区间特性是两回事.

## Taylor级数
如果函数在$x_0$处只有有限阶的导数，或者在含$x_0$ 的某个区间里函数$f(x)$只有有限阶导数，那么直接利用有限阶的Taylor定理即可．

[**定义**]
如果函数$f(x)$在点$x_0$有任何阶$n \in \N$的导数，则级数
$$f(x_0)+f'(x_0)(x-x_0)+\frac{1}{2}f''(x_0)(x-x_0)^2 +...+ \frac{1}{n!}f^{(n)}(x_0)(x-x_0)^n +...$$
称为函数$f$在点$x_0$的泰勒级数．

１．可是不应该认为每个无穷阶可微函数的泰勒级数都在点$x_0$的某个邻域内收敛
２．也不应该认为，如果泰勒级数收敛，它就一定收敛到生成它的函数，仅仅对于被称为解析函数的函数，泰勒级数才收敛到生成它的函数．




[toc]
# 多元函数微分学的几何应用

### 基础集合概念

#### 函数图像的切平面和法向量
在某个区域$G \subset R^2$上给定一个函数定义$z=f(x,y),f \in C^{0}(G)$,那么显然$f:G \to R$.
那么根据函数图像的一般定义，函数$f:G \to R$的图像是空间$R^3$中的集合
$$S=\{(x,y,z) \in R^3 | (x,y) \in G,z=f(x,y) \in R\} $$
显然用关系式$(x,y) \to (x,y,f(x,y))$定义的映射$G \stackrel{F}{\to} S$是一个从$G$到$S$的连续一一映射。

[**引理**]$F:G \to S$是一一映射.
proof:
证明F是单射,任意取定$(x_1,y_1) , (x_2,y_2) \in G,(x_1,y_1) \ne (x_2,y_2)$
那么通过映射F上述点在S里的像为$(x_1,y_1,f(x_1,y_1)) \ne (x_2,y_2,f(x_2,y_2))$
可见F是一个单射。

根据S集合定义，我们知道任意取定一个元素$s \in S$,意味着必然存在$(x,y) \in G$使得
s元素的三个坐标为$(x,y,f(x,y))$这个就证明了$F$的满射性质。

从而F是一个一一映射。

$\blacksquare$


根据这个映射，要想给出集合$S$中任何一个点$(x,y,f(x,y))$，只要给出区域$G$中相应的点解，而这个又等价于给出$G$中这个点的坐标$(x,y)$.

因此序偶$(x,y) \in G$可以看做集合$S$即函数$z=f(x,y)$的图像上的点的某种坐标。因此S的点有两个数给出，所以称S为$R^3$中的二维曲面。

如果给定$G$的道路$\Gamma:I \to G$,自然就可以得到曲面S上的道路$F \circ \Gamma :I \to S$.

如果$x=x(t),y=y(t)$是道路$\Gamma$的参数方程，那么与之对应的S上的道路$F \circ \Gamma$就可以用三个函数来表示
$$x=x(t),y=y(t),z=f(x(t),y(t))$$

特别的如果设$x=x_0+ t,y=y_0$,这个是$G$内平行于$x$轴的直线，那么与之对应的曲面$S$上的曲线为$$x=x_0 + t,y=y_0,z=f(x_0+t,y_0)$$,那么沿着这条曲线全面上S上点的坐标$y=y_0$保持不变，类似的，可以得到曲面S上的另一条曲线$$x=x_0,y=y_0+t,z=f(x_0,y_0+t)$$沿着它，曲面S上的点第一个坐标$x=x_0$也是保持不变的。曲面S上的这些线，类似于平面的情况，自然成为曲面S上的坐标线。$G \subset R^2$上的坐标线是直线，而曲面S上的坐标线不同，一遍是$R^3$中的空间曲线，由于这个原因，曲面S上点的坐标$(x,y)$常常成为S上的曲线坐标。

因此定义在区域$G \subset R^2$上的连续函数$z=f(x,y)$的图像是$R^3$中的二维曲面，它的点可以用曲线坐标$(x,y) \in G$来表示。


如果函数$z=f(x,y)$在点$(x_0,y_0) \in G$可微，那么
$$f(x,y)=f(x_0,y_0)+A(x-x_0)+B(y-y_0)+o(\sqrt{(x-x_0)^2+(y-y_0)^2})$$
其中$A=f_x'(x_0,y_0),B=f_y'(x_0,y_0)$,那么考察$R^3$上的平面方程：
$$z=z_0+A(x-x_0)+B(y-y_0),z_0=f(x_0,y_0)$$

我们的曲面S上的点在$(x_0,y_0,z_0)$内非常接近上面定义的平面。
确切的说，函数图像上的点$(x,y,f(x,y))$有平面上的点$(z,y,z(x,y))$的偏差与量$\sqrt{(x-x_0)^2+(y-y_0)^2}$比较是一个无穷小量。实际上$\sqrt{(x-x_0)^2+(y-y_0)^2}$是从点$(x_0,y_0,z_0)$的坐标到图像上点$(x,y,f(x,y))$的曲线坐标$(x,y)$的位移。
即$$\lim\limits_{(x,y) \to (x_0,y_0)}\frac{f(x,y)-z(x,y)}{\sqrt{(x-x_0)^2 + (y-y_0)^2}}=0$$

由于函数微分的唯一性知道，具有上述性质的平面是唯一的，并有如下形式:
$$z=f(x_0,y_0)+f_x'(x_0,y_0)(x-x_0)+f_y'(x_0,y_0)(y-y_0) \tag{1}$$
我们一般把它称为函数$z=f(x,y)$图像在点$(x_0,y_0,f(x_0,y_0))$的切平面。
于是，通过分析，我们函数$z=f(x,y)$在点$(x_0,y_0)$的可微性与这个函数的图像在点$(x_0,y_0,f(x_0,y_0))$存在切平面是等价的。

将切平面方程$(1)$改写为
$$f_x'(x_0,y_0)(x-x_0)+f_y'(x_0,y_0)(y-y_0)-(z-f(x_0,y_0))=0 \tag{2}$$

那么毫无疑问$(f_x'(x_0,y_0),f_y'(x_0,y_0),-1)$是切平面的法向量。它的方向看书曲面S在点$(x_0,y_0,f(x_0,y_0))$的法像或正交于S的方向。

特别的是，如果点$(x_0,y_0)$是函数$f(x,y)$的临界点，那么图像在点$(x_0,y_0,f(x_0,y_0))$处的法向量为$(0,0,-1)$,那么函数图像在这个点的切平面是水平的。临界点指的是$f_x(x_0,y_0)=f_y(x_0,y_0)=0$的点。

![切平面](./Image/切平面.png)

#### 切平面和切向量
我们知道，在$R^3$中的道路$\Gamma:I \to R^3$可以表示为
$$x=x(t),y=y(t),z=z(t) \tag{2}$$
且$x(t),y(t),z(t)$都是可微函数，那么向量$(\dot{x}(0),\dot{y}(0),\dot{z}(0))$是时刻$t=0$的速度向量。很显然道路上通过点$x_0=x(0),y_0=y(0),z_0=z(0)$且在这个点处与向量$(\dot{x}(0),\dot{y}(0),\dot{z}(0))$相切。

现在考察函数$z=f(x,y)$图像上的道路$\Gamma:I \to S$,它的表示为
$$x=x(t),y=y(t),z=f(x(t),y(t)) \tag{3}$$
此时切向量为
$$(\dot{x}(0),\dot{y}(0),\dot{z}(0))=(\dot{x}(0),\dot{y}(0),f_x'(x_0,y_0)\dot{x}(0)+f_y'(x_0,y_0)\dot{y}(0)) \\
\tag{4}$$

向量$(\dot{x}(0),\dot{y}(0),f_x'(x_0,y_0)\dot{x}(0)+f_y'(x_0,y_0)\dot{y}(0))$和向量$(f_x'(x_0,y_0),f_y'(x_0,y_0),-1)$是垂直的，所以说且向量垂直于函数图像在点$(x_0,y_0,f(x_0,y_0))$的法向量。

当然利用$(3)$表达的曲线必然在曲面$S$上，所以
$$f(x(t),y(t))-z(t) \equiv 0 \tag{5}$$
两边同时对$t$求导,并且取$t=0$则有
$$f_x'(x_0,y_0)\dot{x}(0)+f_y'(x_0,y_0)\dot{y}(0)-\dot{z}(0)=0 \tag{6}$$
也能得到相同的结论.

通过这个分析，我们知道，如果向量$(\xi,\eta,\zeta)$在点$(x_0,y_0,f(x_0,y_0))$与曲面S上过此点的某曲线相切，那么它垂直于点$(x_0,y_0,f(x_0,y_0))$处的法向量$(f_x'(x_0,y_0),f_y'(x_0,y_0),-1)$，并且可以认为这个向量在切平面(2)上，这个平面在所指出的点与曲面S相切。
更确切地说所有直线
$$x=x_0+\xi t,y=y_0+\eta t,z=f(x_0,y_0)+\zeta t \tag{7}$$
都在切平面上。

如果向量$(\xi ,\eta,\zeta)$垂直于点$(x_0,y_0,f(x_0,y_0))$处的法向量$(f_x'(x_0,y_0),f_y'(x_0,y_0),-1)$那么向量$(\xi,\eta,\zeta)$所确定的直线(7)必然在点$(x_0,y_0,f(x_0,y_0))$的切平面上。

通俗地说，函数$z=f(x,y)$的图像曲面上任意一条通过点$(x_0,y_0,f(x_0,y_0))$的曲线$\Gamma$,那么曲线$\Gamma$在点$(x_0,y_0,f(x_0,y_0))$处的切向量，必然在曲面$S在此点的切平面上。

那么逆命题是否成立呢？

即如果直线$x=x_0+\xi t,y=y_0+\eta t,z=f(x_0,y_0)+\zeta t$或者向量$(\xi,\eta,\zeta)$位于函数$z=f(x,y)$图像$S$在点$(x_0,y_0,f(x_0,y_0))$的切平面上，那么在S上实际上是存在一条曲线$\Gamma$，通过点$(x_0,y_0,f(x_0,y_0))$,并且向量$(\xi ,\eta,\zeta)$就是道路$\Gamma$在点$(x_0,y_0,f(x_0,y_0))$处的切向量。

![切向量](Image/切平面和切向量.png)

我们构建这样位于曲面S上的曲线$\Gamma$方程为:
$$x=x_0+\xi t,y=y_0+\eta t,z=f(x_0+\xi t,y_0+\eta t) \tag{8}$$

那么不妨认为$t=0$是通过点$(x_0,y_0,f(x_0,y_0))$,那么曲线在t=0时的切向量为
$$\dot{x}(0)=\xi,\dot{y}(0)=\eta,\dot{z}(0)=f_x'(x_0,y_0)\dot{x}(0)+f_y'(x_0,y_0)\dot{y}(0)=f_x'(x_0,y_0) \xi + f_y'(x_0,y_0)\eta$$

因为直线$x=x_0+\xi t,y=y_0+\eta t,z=f(x_0,y_0)+\zeta t$或者向量$(\xi,\eta,\zeta)$位于函数$z=f(x,y)$图像$S$在点$(x_0,y_0,f(x_0,y_0))$的切平面上，那意味着
$$f_x'(x_0,y_0)\xi +f_y'(x_0,y_0)\eta -\zeta =0$$

所以必然有$\dot{z}(0)=f_x'(x_0,y_0) \xi + f_y'(x_0,y_0)\eta=\zeta$
所以对于曲线$\Gamma$,我们断定$(\dot{x}(0),\dot{y}(0),\dot{z}(0))=(\xi,\eta,\zeta)$

这个就意味着曲面S在点$(x_0,y_0,z_0)$处的切平面是有通过S上点$(x_0,y_0,z_0)$且与过这个点的曲线相切的向量组成的。


在某种程度上说，如果点$(x_0,y_0)$不是函数$z=f(x,y)$的临界点，那么有方程$f_x'(x_0,y_0)d_1+f_y'(x_0,y_0)d_2-d_3=0$确定的解集$E=\{(d_1,d_2,d_3) \in R^3|f_x'(x_0,y_0)d_1+f_y'(x_0,y_0)d_2-d_3=0\}$
与函数$z=f(x,y)$的图像在点$(x_0,y_0,f(x_0,y_0))$的切空间$T_s$是等价的。

将切空间$T_s$定义为图像S上所有过点$(x_0,y_0,f(x_0,y_0))$的曲线在此点处的切向量所组成的空间。

当然上面关于二元函数$z=f(x,y)$的结论，都可以平行地推广到$y=f(x_1,...,x_n)$的函数上去。

### 隐函数存在定理的几何应用

[例２]假定函数$F:G \to R$定义在区域$G \subset R^m$上并且有$f \in C^{1}(G)$.设$x_0=(x_1^{0},...,x_m^{0}) \in G,F(x_0)=F(x_1^{0},...,x_m^{0})=0$,如果$x_0$不是函数Ｆ的临界点，那么函数Ｆ在点$x_0$的偏导数至少一个不为零，不妨假设$\frac{\partial F}{\partial x_m}(x_0) \ne 0$
这个时候通过隐函数存在定理，在点$x_0$的某个邻域中，满足方程$F(x_1,...,x_m)=0$的$R^m$中的点集可以表示成点$(x_1^{0},...,x_{m-1}^{0}) \in R^{m-1}$的一个邻域中定义的某个函数$x_m=f(x_1,...,x_{m-1})$的图像，这个函数在这个邻域是可微的且有$f(x_1^{0},...,x_{m-1}^{0})=x_m^{0}$.

这样，在函数Ｆ的非临界点$x_0$的邻域中，方程$F(x_1,...,x_m)=0$给出了一个(m-1)维的曲面．

特别地，在$R^3$的情况下，方程$F(x,y,z)=0$在非临界点$(x_0,y_0,z_0)$的邻域内给出一个二维曲面，这个曲面在条件$F_z'(x_0,y_0,z_0) \ne 0$之下可以局部地表示为$z=f(x,y)$
我们知道，这个函数的图像在点$(x_0,y_0,z_0)$的切平面方程为
$z-z_0=f_x'(x_0,y_0)(x-x_0) + f_y'(x_0,y_0)(y-y_0)$
通过隐函数存在定理，我们知道$f_x'(x_0,y_0)=-\frac{F_x'(x_0,y_0,z_0)}{F_z'(x_0,y_0,z_0)},f_y'(x_0,y_0)=-\frac{F_y'(x_0,y_0,z_0)}{F_z'(x_0,y_0,z_0)}$
将其代入切平面方程则会有
$$F_x'(x_0,y_0,z_0)(x-x_0)+F_y'(x_0,y_0,z_0)(y-y_0)+ F_z'(x_0,y_0,z_0)(z-z_0) =0 \\
\tag{9}$$
$x,y,z$是切平面上的流动坐标，它关于变量$x,y,z$是对称的．

类似的，对于一般情况下$R^m$中的超平面
$$\sum_{i=1}^{m}F_{x_i}'(x-x_i^{0})=0　\tag{10}$$
它在点$x_0=(x_1^{0},...,x_m^{0})$与由方程$F(x_1,...,x_m)=0$所表示的曲面相切．
所以(10)是通过隐函数$F(x,y,z)=0,F(x_0) =0$在$x_0$的邻域内所确定的曲面的切平面．

很显然对于等高线$F(x,y,z)=r$，取等高线上的一点$(x_0,y_0,z_0)$，即$F(x_0,y_0,z_0)=r$那么毫无疑问在$(x_0,y_0,z_0)$的邻域内满足$F(x,y,z)=r$所确定的曲面$S$在点$(x_0,y_0,z_0)$的切平面还是（９）式，这个也就说明了$gradF(x_0,y_0,z_0)=(F_x'(x_0,y_0,z_0),F_y'(x_0,y_0,z_0),F_z'(x_0,y_0,z_0))$是垂直于曲面Ｓ的，实际上也是说$gradF(x_0,y_0,z_0)$是切平面的法向量．


### 反函数存在定理的几何应用
反函数定理常常应用于从一个坐标系到另一个坐标系的坐标变换，当然最简单的就是线性的坐标变换．即
$$\left[\begin{matrix}
y_1\\
...\\
y_m
\end{matrix}\right]=\left[\begin{matrix}
A_{11},...,A_{1m}\\
...\\
A_{m1},...,A_{mm}
\end{matrix}\right]\left[\begin{matrix}
x_1\\
...\\
x_m
\end{matrix}\right]　\tag{11}$$
可以写成线性变换$A:R_x^{m} \to R_y^{m}$有定义在整个$R_y^{m}$上的逆变换$A^{-1}:R_y^{m} \to R_x^{m}$当且仅当$\det A \ne 0$.
反函数定理是这个断言的局部变化形式，它基于这样一个事实，光滑映射在一点的小邻域内的性质就像它在这一点的微分那样好．

[1]极坐标，从上半平面$R_+^{2}=\{(\rho,\varphi) \in R^2|\rho \ge 0\}$到平面$R^2$的映射$f:R_+^{2} \to R^2$由公式
$$\begin{cases}
x=\rho cos\varphi\\
y=\rho sin\varphi 
\end{cases}
\tag{12}$$
$\frac{\partial(x,y)}{\partial(\rho,\varphi)}=\rho >0$,可见只要$\rho >0$的任何点$(\rho,\varphi)$的任何邻域内也不为０，所以利用反函数存在定理，我们知道(12)是局部可逆的，也就是说，在局部范围内，数$\rho,\varphi$可以作为直角坐标系点$(x,y)$的新坐标．
![](./Image/反函数１.png)

从图上可以观察到，平面$(x,y)$上的圆弧对应着平面$(\rho,\varphi)$上的直线段，这意味着曲线被局部的展平了．

坐标$(\rho,\varphi)$是众所周知的片面上的曲线坐标－－极坐标．
由于所设计的三角函数的周期性，映射仅仅在$\rho >0$的地方是局部微分同胚的，并不能在整个区域上都是双方单值的，所以从笛卡尔坐标转到极坐标时常常需要选取角度$\varphi$的范围．

在三维空间$R^3$中的极坐标$(\rho,\psi,\varphi)$称为球坐标，他们和笛卡尔坐标之间的关系
$$
\begin{cases}
 x=\rho \sin\psi \cos\varphi   \\ 
 y=\rho \sin\psi \sin\varphi   \\
 z=\rho \cos\psi   
\end{cases}　\tag{12}
$$
![](Image/反函数２.png)
参数$\rho,\psi,\varphi$的几何意义如图．

$\frac{\partial(x,y,z)}{\partial(\rho,\psi,\varphi)} =\rho^2\sin\psi$可见，对于球坐标的变换而言在任意一个点$(\rho,\psi,\varphi)(\rho >0,\sin\psi \ne 0)$的邻域内有逆变换．

在空间$(x,y,z)$中满足$\rho=const$的是半径为$\rho$的球面
$\varphi=const$是一个通过ｚ轴的半平面．
$\psi=const$是以ｚ轴为对称轴的圆锥面．

这样，由坐标系$(x,y,z)$转到$(\rho,\psi,\varphi)$ 时，例如球面和锥面可以局部抻平，即他们分配对应小块平面$\rho=const$与$\psi=const$．


[2]
曲线局部抻直的一般想法
新坐标的引入通常是为了简化问题所涉及的对象的解析表达式，使他们在新坐标中更加易于观察．
设$R^2$上用方程$F(x,y)=0$给出的一条曲线，Ｆ是光滑函数，点$(x_0,y_0)$ 在曲线上，即$F(x_0,y_0)=0$,设它不是函数Ｆ的临界点，不妨设$F_y'(x_0,y_0) \ne 0$

我试图选取新的坐标$\xi,\eta$,使得在这个坐标系下，曲线含有点$(x_0,y_0)$的一段弧变成坐标直线，例如$\eta =0$上的一个线段．令
$$\begin{cases}
\xi =x -x_0\\
\eta =F(x,y)    
\end{cases} \tag{13}
$$
当然也可以变为
$$\begin{cases}
\xi =x\\
\eta =F(x,y)    
\end{cases} \tag{14}
$$
前后两个映射没有什么什么本质的区别，只是$(x_0,y_0)$在不同的映射下的坐标不同．
那么(13)所定义的Jacobi矩阵为
$$J_{(x,y)}(\xi,\eta)=\left(\begin{matrix}
1 ,0 \\
F_x',F_y'    
\end{matrix}\right)$$
那么$\frac{\partial(\xi,\eta)}{\partial(x,y)}＝\det J_{(x,y)}(\xi,\eta)=F_y'$那么$\frac{\partial(\xi,\eta)}{\partial(x,y)}(x_0,y_0)=F_y'(x_0,y_0) \ne 0$
那么根据反函数存在定理，我们知道(13)所定义的映射是可逆的，那意味着这个映射是从点$(x_0,y_0)$的邻域到点$(\xi,\eta)=(0,0)$的邻域的微分同胚．
那意味着，在所之处的邻域范围内，数$(\xi,\eta)$可以作为点$(x_0,y_0)$邻域内的点的新坐标．
而在新的坐标系下，我们的曲线方程就变成了$\eta =0$,在这个意义上，我们的变换相当于把曲线局部抻直了．
![](./Image/反函数３.png)
